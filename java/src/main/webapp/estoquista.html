<!DOCTYPE html>
<html>
    <head>

        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>

        <title>Estoque</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <h1>ESTOQUISTA</h1>
        <h2>Atualizar Estoque</h2>
        <div>
            <table id="table" border="1">
                <thead>
                    <tr>
                        <th>ID Produto</th>
                        <th>Nome Produto</th>
                        <th>Valor Produto</th>
                        <th>Quantidade</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            
        </div>
        
        <script>

        $( document ).ready(function() {
    listarProdutos();
});

    function cadastrarProduto() {
        var nome_produto = document.getElementById("nome_produto").value;
        var qtde_produto = document.getElementById("qtde_produto").value;
        var marca_produto = document.getElementById("marca_produto").value;
        var categoria_produto = document.getElementById("categoria_produto").value;
        var descricao_produto = document.getElementById("descricao_produto").value;
        var valor_produto = document.getElementById("valor_produto").value;
        var faq_produto = document.getElementById("faq_produto").value;
        var ativo_produto = document.getElementById("ativo_produto").value;

        axios({
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            url: "/produto",
            params: {
                nomeProduto: nome_produto,
                qtde: qtde_produto,
                marca: marca_produto,
                categoria: categoria_produto,
                descricao: descricao_produto,
                valor: valor_produto,
                faq: faq_produto,
                ativo: ativo_produto

            }
        })
                .then(function (response) {
                    console.log(response);
                })
                .catch(function (error) {
                    console.log(error.response)
                });
    }

    function deletarProduto(id_produto) {
        axios({
            method: "DELETE",
            headers: {
                "Content-Type": "application/json"
            },
            url: "/produto",
            params: {
                nomeProduto: nome_produto,
                qtde: qtde_produto,
                marca: marca_produto,
                categoria: categoria_produto,
                descricao: descricao_produto,
                valor: valor_produto,
                faq: faq_produto
            }
        })
                .then(function (response) {
                    console.log(response);
                })
                .catch(function (error) {
                    console.log(error.response)
                });
    }

    function listarProdutos() {

        $.getJSON('/produto', function (data) {
            
            $.each(data, function (key, item) {
                console.log(item)
    $("#table tbody").append(
            
                        "<tr>" +
                        "<td>"+item.idProduto+"</td>" +
                        "<td>"+item.nomeProduto+"</td>" +
                        "<td>"+item.valor+"</td>" +
                        "<td>"+item.qtde+"</td>" +
                        "<td><input type='number' id='qtde"+item.idProduto+"'> \n\
        <button onclick='atualizarQtde("+item.idProduto+")' id='attQtde'>Adicionar</button></td>"+
                        "</tr>");


            });
        });
        

    }
            function atualizarQtde(id_produto) {
            var quantidade = document.getElementById("qtde"+id_produto).value;
        axios({
            method: "PUT",
            headers: {
                "Content-Type": "application/json"
            },
            url: "/produto",
            params: {
                solicitacao: "attQtde",
                idProduto: id_produto,
                qtde: quantidade
            }
        })
                .then(function (response) {
                    console.log(response);
                })
                .catch(function (error) {
                    console.log(error.response)
                });
    }

</script>
        
    </body>
</html>

